var Blindspot=(()=>{var M=Object.defineProperty;var ht=Object.getOwnPropertyDescriptor;var gt=Object.getOwnPropertyNames;var mt=Object.prototype.hasOwnProperty;var ft=(t,e)=>{for(var o in e)M(t,o,{get:e[o],enumerable:!0})},wt=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of gt(e))!mt.call(t,r)&&r!==o&&M(t,r,{get:()=>e[r],enumerable:!(n=ht(e,r))||n.enumerable});return t};var vt=t=>wt(M({},"__esModule",{value:!0}),t);var qt={};ft(qt,{init:()=>At});var xt=`
.blindspot-trigger {
  position: fixed;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  z-index: 2147483647;
  background: #FE795D;
  color: white;
  border: none;
  padding: 16px 10px 12px 10px;
  border-radius: 8px 0 0 8px;
  cursor: pointer;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-size: 13px;
  font-weight: 500;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  box-shadow: -2px 2px 8px rgba(0,0,0,0.15);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.blindspot-trigger:hover {
  transform: translateY(-50%);
  background: #e5684d;
}

.blindspot-trigger svg {
  width: 18px;
  height: 18px;
  flex-shrink: 0;
}

.blindspot-trigger-text {
  writing-mode: vertical-rl;
  text-orientation: mixed;
  letter-spacing: 0.5px;
}

.blindspot-trigger-dots {
  display: flex;
  flex-direction: column;
  gap: 3px;
  opacity: 0.7;
}

.blindspot-trigger-dots span {
  width: 4px;
  height: 4px;
  background: white;
  border-radius: 50%;
}

/* Overlay */
.blindspot-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 2147483647;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

.blindspot-overlay-backdrop {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #201E1D;
}

.blindspot-overlay-content {
  position: relative;
  display: flex;
  flex-direction: column;
  height: 100%;
  z-index: 1;
  background: transparent;
}

/* Toolbar */
.blindspot-toolbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  background: #201E1D;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

.blindspot-toolbar-tools {
  display: flex;
  align-items: center;
  gap: 8px;
}

.blindspot-close-btn {
  background: transparent;
  border: none;
  color: white;
  cursor: pointer;
  padding: 8px;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.2s;
}

.blindspot-close-btn:hover {
  background: rgba(255,255,255,0.1);
}

/* Tool buttons */
.blindspot-tool-group {
  display: flex;
  align-items: center;
  gap: 4px;
}

.blindspot-tool-divider {
  width: 1px;
  height: 24px;
  background: rgba(255,255,255,0.2);
  margin: 0 8px;
}

.blindspot-tool-btn {
  background: transparent;
  border: none;
  color: rgba(255,255,255,0.7);
  cursor: pointer;
  padding: 8px;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.2s, color 0.2s;
}

.blindspot-tool-btn:hover {
  background: rgba(255,255,255,0.1);
  color: white;
}

.blindspot-tool-btn.active {
  background: #9B78F4;
  color: white;
}

/* Main content area */
.blindspot-main {
  display: flex;
  flex: 1;
  overflow: hidden;
  background: transparent;
}

.blindspot-canvas-area {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  overflow: auto;
  background: #201E1D;
  min-height: 0;
}

.blindspot-canvas-wrapper {
  position: relative;
  max-width: 100%;
  max-height: 100%;
  border-radius: 8px;
  box-shadow: 0 4px 24px rgba(0,0,0,0.3);
  overflow: hidden;
}

.blindspot-screenshot {
  display: block;
  max-width: 100%;
  max-height: calc(100vh - 120px);
}

.blindspot-drawing-canvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  cursor: crosshair;
}

/* Sidebar */
.blindspot-sidebar {
  width: 320px;
  background: white;
  border-left: 1px solid rgba(0,0,0,0.1);
  overflow-y: auto;
  flex-shrink: 0;
}

.blindspot-sidebar-content {
  padding: 20px;
}

.blindspot-sidebar-header {
  margin-bottom: 20px;
}

.blindspot-sidebar-title {
  margin: 0;
  font-size: 18px;
  font-weight: 600;
  color: #201E1D;
}

/* Form */
.blindspot-form {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.blindspot-form-group {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.blindspot-label {
  font-size: 13px;
  font-weight: 500;
  color: #201E1D;
}

.blindspot-input,
.blindspot-textarea {
  padding: 10px 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 14px;
  font-family: inherit;
  transition: border-color 0.2s, box-shadow 0.2s;
}

.blindspot-input:focus,
.blindspot-textarea:focus {
  outline: none;
  border-color: #FE795D;
  box-shadow: 0 0 0 3px rgba(254, 121, 93, 0.15);
}

.blindspot-textarea {
  resize: vertical;
  min-height: 80px;
}

/* Metadata display */
.blindspot-metadata {
  background: #f5f5f5;
  border-radius: 6px;
  padding: 10px 12px;
  font-size: 12px;
}

.blindspot-metadata-item {
  display: flex;
  justify-content: space-between;
  padding: 4px 0;
}

.blindspot-metadata-item:not(:last-child) {
  border-bottom: 1px solid #e5e5e5;
}

.blindspot-metadata-label {
  color: #666;
  font-weight: 500;
}

.blindspot-metadata-value {
  color: #201E1D;
  text-align: right;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 160px;
}

/* Submit button */
.blindspot-submit-btn {
  background: #FE795D;
  color: white;
  border: none;
  padding: 12px 16px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;
  margin-top: 8px;
}

.blindspot-submit-btn:hover {
  background: #e5684d;
}

.blindspot-submit-btn:disabled {
  background: #ccc;
  cursor: not-allowed;
}

/* Success message */
.blindspot-success {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  padding: 40px 20px;
}

.blindspot-success-icon {
  margin-bottom: 16px;
}

.blindspot-success-title {
  margin: 0 0 8px 0;
  font-size: 20px;
  font-weight: 600;
  color: #201E1D;
}

.blindspot-success-text {
  margin: 0 0 20px 0;
  color: #666;
  font-size: 14px;
}

.blindspot-success-link {
  display: inline-block;
  background: #FE795D;
  color: white;
  text-decoration: none;
  padding: 10px 20px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 500;
  margin-bottom: 12px;
  transition: background 0.2s;
}

.blindspot-success-link:hover {
  background: #e5684d;
}

.blindspot-close-overlay-btn {
  background: transparent;
  border: 1px solid #ddd;
  color: #666;
  padding: 8px 16px;
  border-radius: 6px;
  font-size: 14px;
  cursor: pointer;
  transition: background 0.2s;
}

.blindspot-close-overlay-btn:hover {
  background: #f5f5f5;
}
`;function W(){if(document.getElementById("blindspot-styles"))return;let t=document.createElement("style");t.id="blindspot-styles",t.textContent=xt,document.head.appendChild(t)}var yt=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/>
</svg>
`,c=null,D=null;function P(t){return c||(D=t,c=document.createElement("button"),c.className="blindspot-trigger",c.innerHTML=`
    ${yt}
    <span class="blindspot-trigger-text">Report issue</span>
    <span class="blindspot-trigger-dots">
      <span></span>
      <span></span>
      <span></span>
    </span>
  `,c.setAttribute("aria-label","Report a bug"),c.addEventListener("click",kt),document.body.appendChild(c),c)}function kt(){console.log("[Blindspot] Trigger clicked"),D&&D()}function q(){c&&(c.style.display="none")}function R(){c&&(c.style.display="flex")}var St="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js",Y=!1;function Et(){return new Promise((t,e)=>{if(Y&&window.html2canvas){t(window.html2canvas);return}let o=document.createElement("script");o.src=St,o.onload=()=>{Y=!0,console.log("[Blindspot] html2canvas loaded"),t(window.html2canvas)},o.onerror=()=>{e(new Error("Failed to load html2canvas"))},document.head.appendChild(o)})}async function X(){console.log("[Blindspot] Capturing screenshot...");let t=await Et(),e=document.querySelector(".blindspot-trigger");e&&(e.style.visibility="hidden");try{let o=window.getComputedStyle(document.body).backgroundColor,n=window.getComputedStyle(document.documentElement).backgroundColor,r=o!=="rgba(0, 0, 0, 0)"?o:n!=="rgba(0, 0, 0, 0)"?n:"#ffffff",l=await t(document.documentElement,{useCORS:!0,allowTaint:!0,backgroundColor:r,scrollX:-window.scrollX,scrollY:-window.scrollY,windowWidth:document.documentElement.clientWidth,windowHeight:document.documentElement.clientHeight,width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,x:window.scrollX,y:window.scrollY}),E=l.toDataURL("image/png");return console.log("[Blindspot] Screenshot captured",{width:l.width,height:l.height,size:Math.round(E.length/1024)+"kb"}),E}finally{e&&(e.style.visibility="visible")}}var $=null;function N(t,e){return $=e,`
    <div class="blindspot-sidebar-content">
      <div class="blindspot-sidebar-header">
        <h2 class="blindspot-sidebar-title">Report Issue</h2>
      </div>

      <form class="blindspot-form" id="blindspot-form">
        <div class="blindspot-form-group">
          <label class="blindspot-label" for="blindspot-title">Title *</label>
          <input
            type="text"
            id="blindspot-title"
            class="blindspot-input"
            placeholder="Brief description of the issue"
            required
          />
        </div>

        <div class="blindspot-form-group">
          <label class="blindspot-label" for="blindspot-description">Description</label>
          <textarea
            id="blindspot-description"
            class="blindspot-textarea"
            placeholder="Steps to reproduce, expected behavior, etc."
            rows="4"
          ></textarea>
        </div>

        <div class="blindspot-form-group">
          <label class="blindspot-label" for="blindspot-reporter">Submitted by</label>
          <input
            type="text"
            id="blindspot-reporter"
            class="blindspot-input"
            placeholder="Your name or email (optional)"
          />
        </div>

        <div class="blindspot-form-group">
          <label class="blindspot-label">Captured Info</label>
          <div class="blindspot-metadata">
            <div class="blindspot-metadata-item">
              <span class="blindspot-metadata-label">URL</span>
              <span class="blindspot-metadata-value" title="${t.url}">${Tt(t.url,35)}</span>
            </div>
            <div class="blindspot-metadata-item">
              <span class="blindspot-metadata-label">Browser</span>
              <span class="blindspot-metadata-value">${t.browser}</span>
            </div>
            <div class="blindspot-metadata-item">
              <span class="blindspot-metadata-label">OS</span>
              <span class="blindspot-metadata-value">${t.os}</span>
            </div>
            <div class="blindspot-metadata-item">
              <span class="blindspot-metadata-label">Viewport</span>
              <span class="blindspot-metadata-value">${t.viewport}</span>
            </div>
          </div>
        </div>

        <button type="submit" class="blindspot-submit-btn">
          Submit Bug Report
        </button>
      </form>
    </div>
  `}function _(){let t=document.getElementById("blindspot-form");t&&t.addEventListener("submit",Ct)}function Ct(t){t.preventDefault();let e=document.getElementById("blindspot-title").value.trim(),o=document.getElementById("blindspot-description").value.trim(),n=document.getElementById("blindspot-reporter").value.trim();e&&(console.log("[Blindspot] Form submitted",{title:e,description:o,reporter:n}),$&&$({title:e,description:o,reporter:n}))}function Tt(t,e){return t.length<=e?t:t.substring(0,e)+"..."}function V(){return{url:window.location.href,browser:Bt(),os:Lt(),viewport:`${window.innerWidth}x${window.innerHeight}`,screenSize:`${window.screen.width}x${window.screen.height}`,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,consoleErrors:Dt()}}function Bt(){let t=navigator.userAgent;if(t.includes("Firefox/")){let e=t.match(/Firefox\/(\d+)/);return`Firefox ${e?e[1]:""}`}if(t.includes("Edg/")){let e=t.match(/Edg\/(\d+)/);return`Edge ${e?e[1]:""}`}if(t.includes("Chrome/")){let e=t.match(/Chrome\/(\d+)/);return`Chrome ${e?e[1]:""}`}if(t.includes("Safari/")&&!t.includes("Chrome")){let e=t.match(/Version\/(\d+)/);return`Safari ${e?e[1]:""}`}return"Unknown"}function Lt(){let t=navigator.userAgent;if(t.includes("Mac OS X")){let e=t.match(/Mac OS X (\d+[._]\d+)/);return e?`macOS ${e[1].replace("_",".")}`:"macOS"}return t.includes("Windows NT 10")?"Windows 10/11":t.includes("Windows NT 6.3")?"Windows 8.1":t.includes("Windows NT 6.2")?"Windows 8":t.includes("Windows NT 6.1")?"Windows 7":t.includes("Linux")?"Linux":t.includes("Android")?"Android":t.includes("iOS")||t.includes("iPhone")||t.includes("iPad")?"iOS":"Unknown"}var g=[],K=10,Mt=console.error;console.error=function(...t){g.push({type:"error",message:t.map(e=>String(e)).join(" "),timestamp:new Date().toISOString()}),g.length>K&&g.shift(),Mt.apply(console,t)};typeof window<"u"&&window.addEventListener("error",t=>{g.push({type:"uncaught",message:t.message,filename:t.filename,line:t.lineno,timestamp:new Date().toISOString()}),g.length>K&&g.shift()});function Dt(){return[...g]}var s=null,i=null,C=!1,u="arrow",b=0,h=0,I=0,O=0,p=[],v=null,a=null,T="#9B78F4",G=3,Rt=16;function U(t){s=t,i=s.getContext("2d"),i.strokeStyle=T,i.lineWidth=G,i.lineCap="round",i.lineJoin="round",s.addEventListener("mousedown",j),s.addEventListener("mousemove",z),s.addEventListener("mouseup",x),s.addEventListener("mouseleave",x),s.addEventListener("touchstart",ot,{passive:!1}),s.addEventListener("touchmove",nt,{passive:!1}),s.addEventListener("touchend",it),console.log("[Blindspot] Canvas initialized",{width:s.width,height:s.height})}function Z(t){u=t,console.log("[Blindspot] Tool set to:",t)}function Q(){!i||!s||(i.clearRect(0,0,s.width,s.height),p=[],console.log("[Blindspot] Canvas cleared"))}function tt(){p.length!==0&&(p.pop(),y(),console.log("[Blindspot] Undo - paths remaining:",p.length))}function et(){return p.length>0}function j(t){let e=s.getBoundingClientRect(),o=s.width/e.width,n=s.height/e.height;if(b=(t.clientX-e.left)*o,h=(t.clientY-e.top)*n,I=b,O=h,u==="text"){$t(t.clientX,t.clientY,b,h);return}C=!0,u==="draw"&&(v={type:"draw",points:[{x:b,y:h}]})}function z(t){if(!C)return;let e=s.getBoundingClientRect(),o=s.width/e.width,n=s.height/e.height,r=(t.clientX-e.left)*o,l=(t.clientY-e.top)*n;u==="draw"?(i.beginPath(),i.moveTo(I,O),i.lineTo(r,l),i.stroke(),v.points.push({x:r,y:l}),I=r,O=l):(y(),It(r,l))}function x(t){if(!C)return;C=!1;let e=s.getBoundingClientRect(),o=s.width/e.width,n=s.height/e.height,r=(t.clientX-e.left)*o,l=(t.clientY-e.top)*n;u==="draw"&&v?(p.push(v),v=null):u==="arrow"?(p.push({type:"arrow",startX:b,startY:h,endX:r,endY:l}),y()):u==="rectangle"&&(p.push({type:"rectangle",startX:b,startY:h,endX:r,endY:l}),y())}function $t(t,e,o,n){w();let r=document.createElement("div");r.id="blindspot-text-container",r.style.cssText=`
    position: fixed;
    left: ${t}px;
    top: ${e}px;
    z-index: 2147483647;
    transform: translate(0, -50%);
  `,a=document.createElement("input"),a.type="text",a.style.cssText=`
    background: white;
    border: 2px solid ${T};
    border-radius: 4px;
    padding: 6px 10px;
    font-size: 14px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    color: #201E1D;
    outline: none;
    min-width: 150px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  `,a.placeholder="Type text...";let l=f=>{f.stopPropagation(),f.key==="Enter"?(f.preventDefault(),a.value.trim()&&J(o,n,a.value.trim()),w()):f.key==="Escape"&&(f.preventDefault(),w())},E=()=>{setTimeout(()=>{a&&a.value.trim()&&J(o,n,a.value.trim()),w()},100)};a.addEventListener("keydown",l),a.addEventListener("blur",E),r.appendChild(a),document.body.appendChild(r),setTimeout(()=>{a&&a.focus()},10),console.log("[Blindspot] Text input shown at",t,e)}function w(){let t=document.getElementById("blindspot-text-container");t&&t.remove(),a=null}function J(t,e,o){p.push({type:"text",x:t,y:e,text:o}),y(),console.log("[Blindspot] Text added:",o)}function ot(t){t.preventDefault();let e=t.touches[0],o=new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY});j(o)}function nt(t){t.preventDefault();let e=t.touches[0],o=new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY});z(o)}function it(t){let e=new MouseEvent("mouseup",{});x(e)}function It(t,e){u==="arrow"?st(b,h,t,e):u==="rectangle"&&rt(b,h,t,e)}function y(){i.clearRect(0,0,s.width,s.height),i.strokeStyle=T,i.lineWidth=G;for(let t of p)t.type==="draw"?Ot(t.points):t.type==="arrow"?st(t.startX,t.startY,t.endX,t.endY):t.type==="rectangle"?rt(t.startX,t.startY,t.endX,t.endY):t.type==="text"&&Ut(t.x,t.y,t.text)}function Ot(t){if(!(t.length<2)){i.beginPath(),i.moveTo(t[0].x,t[0].y);for(let e=1;e<t.length;e++)i.lineTo(t[e].x,t[e].y);i.stroke()}}function st(t,e,o,n){let l=Math.atan2(n-e,o-t);i.beginPath(),i.moveTo(t,e),i.lineTo(o,n),i.stroke(),i.beginPath(),i.moveTo(o,n),i.lineTo(o-15*Math.cos(l-Math.PI/6),n-15*Math.sin(l-Math.PI/6)),i.moveTo(o,n),i.lineTo(o-15*Math.cos(l+Math.PI/6),n-15*Math.sin(l+Math.PI/6)),i.stroke()}function rt(t,e,o,n){i.beginPath(),i.rect(t,e,o-t,n-e),i.stroke()}function Ut(t,e,o){i.font=`bold ${Rt}px -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif`,i.fillStyle=T,i.fillText(o,t,e)}function lt(){s&&(w(),s.removeEventListener("mousedown",j),s.removeEventListener("mousemove",z),s.removeEventListener("mouseup",x),s.removeEventListener("mouseleave",x),s.removeEventListener("touchstart",ot),s.removeEventListener("touchmove",nt),s.removeEventListener("touchend",it),s=null,i=null,p=[])}var at=null,k=null,m={arrow:`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <line x1="5" y1="12" x2="19" y2="12"/>
    <polyline points="12 5 19 12 12 19"/>
  </svg>`,rectangle:`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
  </svg>`,text:`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <polyline points="4 7 4 4 20 4 20 7"/>
    <line x1="9" y1="20" x2="15" y2="20"/>
    <line x1="12" y1="4" x2="12" y2="20"/>
  </svg>`,draw:`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M12 19l7-7 3 3-7 7-3-3z"/>
    <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
    <path d="M2 2l7.586 7.586"/>
    <circle cx="11" cy="11" r="2"/>
  </svg>`,undo:`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M3 7v6h6"/>
    <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"/>
  </svg>`,clear:`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M3 6h18"/>
    <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
    <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
  </svg>`};function dt(){return`
    <div class="blindspot-tool-group">
      <button class="blindspot-tool-btn active" data-tool="arrow" title="Arrow">
        ${m.arrow}
      </button>
      <button class="blindspot-tool-btn" data-tool="rectangle" title="Box">
        ${m.rectangle}
      </button>
      <button class="blindspot-tool-btn" data-tool="text" title="Text">
        ${m.text}
      </button>
      <button class="blindspot-tool-btn" data-tool="draw" title="Freeform">
        ${m.draw}
      </button>
    </div>
    <div class="blindspot-tool-divider"></div>
    <div class="blindspot-tool-group">
      <button class="blindspot-tool-btn" data-action="undo" title="Undo">
        ${m.undo}
      </button>
      <button class="blindspot-tool-btn" data-action="clear" title="Clear all">
        ${m.clear}
      </button>
    </div>
  `}function ct(t){at=t,t.querySelectorAll("[data-tool]").forEach(n=>{n.addEventListener("click",()=>{let r=n.dataset.tool;Z(r),jt(n)})}),t.querySelectorAll("[data-action]").forEach(n=>{n.addEventListener("click",()=>{let r=n.dataset.action;r==="undo"?tt():r==="clear"&&Q()})}),k=t.querySelector('[data-tool="arrow"]')}function jt(t){k&&k.classList.remove("active"),t.classList.add("active"),k=t}function pt(){at=null,k=null}var d=null,H=null,L=null,B=null,F=null;function ut(t,e={}){d||(H=t,B=e.onClose,F=e.onSubmit,L=V(),d=document.createElement("div"),d.className="blindspot-overlay",d.innerHTML=`
    <div class="blindspot-overlay-backdrop"></div>
    <div class="blindspot-overlay-content">
      <div class="blindspot-toolbar">
        <div class="blindspot-toolbar-tools">
          ${dt()}
        </div>
        <button class="blindspot-close-btn" aria-label="Close">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="blindspot-main">
        <div class="blindspot-canvas-area">
          <div class="blindspot-canvas-wrapper">
            <img class="blindspot-screenshot" src="${t}" alt="Screenshot" />
            <canvas class="blindspot-drawing-canvas"></canvas>
          </div>
        </div>
        <div class="blindspot-sidebar">
          ${N(L,zt)}
        </div>
      </div>
    </div>
  `,d.querySelector(".blindspot-close-btn").addEventListener("click",A),d.querySelector(".blindspot-overlay-backdrop").addEventListener("click",A),document.addEventListener("keydown",bt),document.body.appendChild(d),document.body.style.overflow="hidden",setTimeout(()=>{let o=d.querySelector(".blindspot-toolbar-tools");ct(o);let n=d.querySelector(".blindspot-screenshot"),r=d.querySelector(".blindspot-drawing-canvas");n.onload=()=>{r.width=n.naturalWidth,r.height=n.naturalHeight,U(r)},n.complete&&(r.width=n.naturalWidth,r.height=n.naturalHeight,U(r)),_()},0),console.log("[Blindspot] Overlay opened"))}function A(){d&&(document.removeEventListener("keydown",bt),document.body.style.overflow="",pt(),lt(),d.remove(),d=null,H=null,L=null,B&&(B(),B=null),console.log("[Blindspot] Overlay closed"))}function bt(t){t.key==="Escape"&&A()}function zt(t){if(F){let e=H;et()&&(e=Ft()),F({...t,screenshot:e,metadata:L})}}function Ft(){let t=d.querySelector(".blindspot-screenshot"),e=d.querySelector(".blindspot-drawing-canvas"),o=document.createElement("canvas");o.width=t.naturalWidth,o.height=t.naturalHeight;let n=o.getContext("2d");return n.drawImage(t,0,0),n.drawImage(e,0,0),o.toDataURL("image/png")}var S={repo:null,workerUrl:null};function At(t={}){if(!t.repo){console.error("[Blindspot] Missing required option: repo");return}if(!t.workerUrl){console.error("[Blindspot] Missing required option: workerUrl");return}S.repo=t.repo,S.workerUrl=t.workerUrl,W(),P(Ht),console.log("[Blindspot] Initialized",{repo:S.repo})}async function Ht(){console.log("[Blindspot] Starting capture mode...");try{q();let t=await X();console.log("[Blindspot] Screenshot ready, opening overlay..."),ut(t,{onClose:()=>{R()},onSubmit:Wt})}catch(t){console.error("[Blindspot] Capture failed:",t),R()}}async function Wt(t){console.log("[Blindspot] Submitting report...",t);let e=document.querySelector(".blindspot-submit-btn");e&&(e.disabled=!0,e.textContent="Submitting...");try{let o=await fetch(`${S.workerUrl}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t.title,description:t.description,reporter:t.reporter,screenshot:t.screenshot,metadata:t.metadata,repo:S.repo})}),n=await o.json();if(!o.ok)throw new Error(n.error||"Failed to submit report");console.log("[Blindspot] Report submitted successfully:",n),Pt(n.issueUrl)}catch(o){console.error("[Blindspot] Submit failed:",o),alert(`Failed to submit report: ${o.message}`),e&&(e.disabled=!1,e.textContent="Submit Bug Report")}}function Pt(t){let e=document.querySelector(".blindspot-sidebar-content");e&&(e.innerHTML=`
      <div class="blindspot-success">
        <div class="blindspot-success-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22 4 12 14.01 9 11.01"/>
          </svg>
        </div>
        <h3 class="blindspot-success-title">Report Submitted!</h3>
        <p class="blindspot-success-text">Your bug report has been created successfully.</p>
        ${t?`<a href="${t}" target="_blank" class="blindspot-success-link">View Issue on GitHub</a>`:""}
        <button class="blindspot-close-overlay-btn" onclick="document.querySelector('.blindspot-close-btn').click()">Close</button>
      </div>
    `)}return vt(qt);})();
